# Лабораторная работа 4

## Вариант 1 "Библиотека"(с некоторым дополнением)

* **Цель:** освоить реализацию пользовательских коллекций
* **Библиотеки:** *dataclass*, *collections*, **sortedcontainers**, *logger*, *abc*, *random*
* **Чему я научился:**
    * работа с ``UserDict``
    * реализация списковой коллекции через композицию
    * работа с магическими методами

## Решение
В рамках лабораторной работы была реализована мини база данных. Она поддерживает простейшие операции(вставка; обновление; выбор; удаление; простые фильтры: равенство, больше, меньше, наличие в списке некоторого поля), а также базовую индексацию(простой индекс, ранжированный индекс для быстрого поиска по больше/меньше), ограничения(н., уникальность значения поля).

### Реализованные коллекции и структуры

* **Списковая коллекция**([Collection](./src/orm/collection.py)). Можно инициализировать коллецию с некоторым фиксированным ``dtype``(вставка будет работать только если элемент верного типа).
* **Неизменяемая списковая коллекция**([ImmutableCollection](./src/orm/collection.py)). Принимает на вход обычную коллекцию, не позволяет добавлять/удалять элементы используя API.
* **Абстрактный индекс**([AbstractIndex](./src/orm/index/abstract.py)). Описывает необходимые методы и атрибуты, содержит в себе некоторые базовые
* **Простой индекс**([BaseIndex](./src/orm/index/index_types.py)). Содержит в себе позиции(ссылки) на элементы в коллекции по значению поля
* **Range индекс**([BaseIndex](./src/orm/index/index_types.py)). То же самое, что и простой индекс, но за основу хранения данных взят **SortedDict**
* **Исключения**([Исключения](./src/orm/exceptions.py))
* **Таблица**([Table](./src/orm/table.py)). Хранит в себе коллекцию заданного типа(``dtype``), индексы и ограничения. Поддерживает операции вставки, обновления, поиска, удаления. Автоматически обновляет индексы по необходимости
* **Сессия**([DatabaseSession](./src/database/session.py)). Хранит в себе таблицы, ``dtype-ы``. Поддерживает те же операции, что и таблица, но имеет обертку фильтров для операций удаления, обновления по фильтрам, а так же возвращает ``ImmutableCollection``: объекты ``dtype`` таблицы в ``select_rows``(по умолчанию таблица возвращает позиции в коллекции


## Использование

### Установка
``pip install -e git+https://github.com/stepzak/python-lab-4#egg=python-lab-4``

``cd src/python-lab-4``

### Тестирование
``pytest``

### Запуск
``python -m src.main``
